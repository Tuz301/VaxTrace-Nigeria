# ============================================
# VaxTrace Nigeria - GxCP Production Environment
# ============================================
# This is a production environment template for deploying VaxTrace
# on Galaxy Backbone (GBB) Cloud OpenStack infrastructure.
#
# PREREQUISITES:
# 1. Copy this file to .env and fill in ALL required values
# 2. Generate strong passwords using: openssl rand -base64 32
# 3. Store credentials securely in a password manager
# 4. NEVER commit .env to version control!

# ============================================
# GxCP Infrastructure Configuration
# ============================================
# GBB Cloud OpenStack Settings
GBB_AUTH_URL=https://api.galaxybackbone.com:5000/v3
GBB_DOMAIN_NAME=Default
GBB_TENANT_NAME=vaxtrace-production
GBB_REGION=ng-abuja
GBB_PRIMARY_AZ=abuja-zone-1
GBB_DR_AZ=kano-zone-1

# ============================================
# Application Configuration (Production)
# ============================================
NODE_ENV=production
APP_NAME=VaxTrace Nigeria
APP_URL=https://vaxtrace.gov.ng
API_URL=https://api.vaxtrace.gov.ng
PORT=8000
BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')

# ============================================
# Frontend Configuration
# ============================================
NEXT_PUBLIC_API_URL=https://api.vaxtrace.gov.ng
NEXT_PUBLIC_WS_URL=wss://api.vaxtrace.gov.ng
FRONTEND_PORT=3000

# Map Configuration (Mapbox)
NEXT_PUBLIC_MAPBOX_TOKEN=your_mapbox_token_here
NEXT_PUBLIC_DEFAULT_LAT=9.0820
NEXT_PUBLIC_DEFAULT_LNG=8.6753
NEXT_PUBLIC_DEFAULT_ZOOM=6

# Feature Flags
NEXT_PUBLIC_ENABLE_BIOMETRIC=true
NEXT_PUBLIC_ENABLE_OFFLINE=true
NEXT_PUBLIC_ENABLE_PWA=true

# OpenLMIS Public URL
NEXT_PUBLIC_OPENLMIS_URL=https://nglmis.nphcda.gov.ng

# ============================================
# Backend Configuration
# ============================================
BACKEND_PORT=8000
WS_PORT=8001
CORS_ORIGIN=https://vaxtrace.gov.ng

# Rate Limiting
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# ============================================
# Database Configuration (PostgreSQL + PostGIS)
# ============================================
POSTGRES_USER=vaxtrace_admin
POSTGRES_PASSWORD=CHANGE_THIS_GENERATE_32_CHAR_PASSWORD
POSTGRES_DB=vaxtrace_nigeria
POSTGRES_PORT=5432
POSTGRES_HOST=postgres

# Connection Pool Settings
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=50
DATABASE_SSL=false

# GxCP PostgreSQL Settings
POSTGRES_FLAVOR=m1.xlarge
POSTGRES_STORAGE_SIZE=500
POSTGRES_STORAGE_TYPE=ssd

# ============================================
# Redis Configuration
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_TLS_PORT=6380
REDIS_PASSWORD=CHANGE_THIS_GENERATE_32_CHAR_PASSWORD
REDIS_TLS=false
REDIS_DB=0

# GxCP Redis Settings
REDIS_FLAVOR=m1.large
REDIS_STORAGE_SIZE=50
REDIS_STORAGE_TYPE=ssd
REDIS_MAX_MEMORY=512mb

# ============================================
# Security & Encryption
# ============================================
# JWT Configuration
JWT_SECRET=CHANGE_THIS_GENERATE_64_CHAR_SECRET_MINIMUM
JWT_EXPIRATION=1h
JWT_REFRESH_EXPIRATION=7d

# AES-256 Encryption (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=CHANGE_THIS_GENERATE_64_CHAR_HEX_KEY

# Webhook Signature Verification
WEBHOOK_SECRET=CHANGE_THIS_GENERATE_64_CHAR_SECRET

# ============================================
# OpenLMIS Integration (Nigeria National)
# ============================================
OPENLMIS_BASE_URL=https://nglmis.nphcda.gov.ng
OPENLMIS_CLIENT_ID=vaxtrace-service
OPENLMIS_CLIENT_SECRET=CHANGE_THIS_GET_FROM_OPENLMIS
OPENLMIS_REFRESH_TOKEN=CHANGE_THIS_GET_FROM_OPENLMIS
OPENLMIS_GRANT_TYPE=client_credentials

# ============================================
# Monitoring & Observability
# ============================================
# Sentry Error Tracking
SENTRY_DSN=https://your-project@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.05

# Frontend Sentry (Public DSN)
NEXT_PUBLIC_SENTRY_DSN=https://your-project@sentry.io/project-id

# PostHog Analytics
NEXT_PUBLIC_POSTHOG_KEY=phc_your_posthog_key_here
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com
POSTHOG_KEY=phc_your_posthog_key_here

# ============================================
# TLS/SSL Configuration (GxCP)
# ============================================
TLS_CERT_PATH=/app/config/tls/vaxtrace.crt
TLS_KEY_PATH=/app/config/tls/vaxtrace.key
TLS_CA_PATH=/app/config/tls/gbb-ca.crt

# Nginx SSL Ports
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# ============================================
# Logging Configuration
# ============================================
LOG_LEVEL=info
LOG_FORMAT=json

# ============================================
# Development Tools (DISABLED IN PRODUCTION)
# ============================================
# These services are only available with --profile development
PGADMIN_EMAIL=admin@vaxtrace.ng
PGADMIN_PASSWORD=CHANGE_THIS_FOR_DEV
PGADMIN_PORT=5050

REDIS_COMMANDER_PORT=8081

# ============================================
# NDPR Compliance (Nigeria Data Protection Regulation)
# ============================================
DATA_RETENTION_DAYS=2555  # 7 years
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=90

# ============================================
# GxCP Resource Limits
# ============================================
# Backend (m1.large: 4 vCPU, 8GB RAM)
BACKEND_CPU_LIMIT=3.5
BACKEND_MEMORY_LIMIT=7G
BACKEND_CPU_RESERVATION=1.0
BACKEND_MEMORY_RESERVATION=2G

# Frontend (m1.medium: 2 vCPU, 4GB RAM)
FRONTEND_CPU_LIMIT=1.5
FRONTEND_MEMORY_LIMIT=3.5G
FRONTEND_CPU_RESERVATION=0.5
FRONTEND_MEMORY_RESERVATION=1G

# Nginx (m1.small: 1 vCPU, 2GB RAM)
NGINX_CPU_LIMIT=0.8
NGINX_MEMORY_LIMIT=1.5G
NGINX_CPU_RESERVATION=0.25
NGINX_MEMORY_RESERVATION=512M

# ============================================
# Health Check Settings
# ============================================
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=60s
